<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.skyeye.dao.IfsAccountSubjectDao">

    <select id="queryIfsAccountSubjectList" parameterType="java.util.Map" resultType="java.util.Map">
        SELECT
            a.id,
            a.name `name`,
            a.num num,
            a.type,
            CASE a.state WHEN '1' THEN '启用' WHEN '2' THEN '停用' ELSE a.state END state,
            a.remark,
            d.user_name createName,
            CONVERT(a.create_time, char) createTime,
            e.user_name lastUpdateName,
            CONVERT(a.last_update_time, char) lastUpdateTime
        FROM
            ifs_account_subject  a
            LEFT JOIN sys_eve_user_staff d ON a.create_id = d.user_id
            LEFT JOIN sys_eve_user_staff e ON a.last_update_id = e.user_id
        WHERE
            1 = 1
        <if test="type != '' and type != null">
            AND a.type = #{type}
        </if>
        <if test="state != '' and state != null">
            AND a.state = #{state}
        </if>
        <if test="name != '' and name != null">
            AND a.name LIKE '%${name}%'
        </if>
        ORDER BY a.last_update_time DESC
    </select>

    <select id="queryIfsAccountSubjectMationByName" parameterType="java.util.Map" resultType="java.util.Map">
        SELECT
            a.id
        FROM
            ifs_account_subject a
        WHERE
            a.name = #{name}
        <if test="id != '' and id != null">
            AND a.id != #{id}
        </if>
    </select>

    <select id="queryIfsAccountSubjectMationByNum" parameterType="java.util.Map" resultType="java.util.Map">
        SELECT
            a.id
        FROM
            ifs_account_subject a
        WHERE a.num = #{num}
        <if test="id != '' and id != null">
            AND a.id != #{id}
        </if>
    </select>

    <insert id="insertIfsAccountSubject" parameterType="java.util.Map">
        INSERT INTO ifs_account_subject (id, num, `name`, state, `type`, remark, create_id, create_time, last_update_id, last_update_time
        ) VALUES 
        (#{id}, #{num}, #{name}, #{state}, #{type}, #{remark}, #{userId}, #{createTime}, #{userId}, #{createTime})
    </insert>

    <select id="queryIfsAccountSubjectToEditById" parameterType="java.util.Map" resultType="java.util.Map">
        SELECT
            a.id,
            a.name `name`,
            a.state state,
            a.num num,
            a.type `type`,
            a.remark
        FROM
            ifs_account_subject  a
        WHERE
            a.id = #{id}
    </select>

    <update id="editIfsAccountSubjectById" parameterType="java.util.Map">
        UPDATE ifs_account_subject 
        <set>
            `name` = #{name},
            state = #{state},
            `type` = #{type},
            num = #{num},
            remark = #{remark},
            last_update_id = #{userId},
            last_update_time = #{lastUpdateTime}
        </set>
        WHERE
            id = #{id}
    </update>

    <delete id="deleteIfsAccountSubjectById" parameterType="java.util.Map">
        DELETE
		FROM
			ifs_account_subject
		WHERE
			id = #{id}
    </delete>

</mapper>