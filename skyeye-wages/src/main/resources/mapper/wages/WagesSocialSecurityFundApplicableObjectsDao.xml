<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.skyeye.eve.dao.WagesSocialSecurityFundApplicableObjectsDao">

    <insert id="insertWagesSocialSecurityFundApplicableObjects">
        INSERT INTO wages_social_security_fund_applicable_objects
        (security_fund_id, object_id, object_type)
        VALUES
        <foreach collection="list" item="item" index="index" separator="," >
            (#{item.securityFundId}, #{item.objectId}, #{item.objectType})
        </foreach>
    </insert>

    <delete id="deleteWagesSocialSecurityFundApplicableObjectsBySecurityFundId">
        DELETE
        FROM
            wages_social_security_fund_applicable_objects
        WHERE
            security_fund_id = #{securityFundId}
    </delete>

    <select id="queryWagesSocialSecurityFundApplicableObjectsBySecurityFundId" resultType="java.util.Map">
        SELECT
            a.security_fund_id securityFundId,
            a.object_id objectId,
            a.object_type objectType
        FROM
            wages_social_security_fund_applicable_objects a
        WHERE a.security_fund_id = #{securityFundId}
    </select>

    <select id="queryAllWagesSocialSecurityFundApplicableObjects" resultType="java.util.Map">
        SELECT
            b.security_fund_id securityFundId,
            b.object_id objectId,
            a.title,
            a.sort_no sortNo,
            IFNULL(a.enclosure, '') enclosure,
            CONVERT(a.insurance_endowment_base, decimal(24, 2)) insuranceEndowmentBase,
            CONVERT(a.insurance_endowment_person, decimal(24, 2)) insuranceEndowmentPerson,
            CONVERT(a.insurance_endowment_company, decimal(24, 2)) insuranceEndowmentCompany,
            CONVERT(a.insurance_unemployment_base, decimal(24, 2)) insuranceUnemploymentBase,
            CONVERT(a.insurance_unemployment_person, decimal(24, 2)) insuranceUnemploymentPerson,
            CONVERT(a.insurance_unemployment_company, decimal(24, 2)) insuranceUnemploymentCompany,
            CONVERT(a.insurance_employment_base, decimal(24, 2)) insuranceEmploymentBase,
            CONVERT(a.insurance_employment_person, decimal(24, 2)) insuranceEmploymentPerson,
            CONVERT(a.insurance_employment_company, decimal(24, 2)) insuranceEmploymentCompany,
            CONVERT(a.insurance_maternity_base, decimal(24, 2)) insuranceMaternityBase,
            CONVERT(a.insurance_maternity_person, decimal(24, 2)) insuranceMaternityPerson,
            CONVERT(a.insurance_maternity_company, decimal(24, 2)) insuranceMaternityCompany,
            CONVERT(a.insurance_medical_base, decimal(24, 2)) insuranceMedicalBase,
            CONVERT(a.insurance_medical_person, decimal(24, 2)) insuranceMedicalPerson,
            CONVERT(a.insurance_medical_company, decimal(24, 2)) insuranceMedicalCompany,
            CONVERT(a.ins_total_seriously_ill_individual, decimal(24, 2)) insTotalSeriouslyIllIndividual,
            CONVERT(a.ins_total_person, decimal(24, 2)) insTotalPerson,
            CONVERT(a.ins_total_company, decimal(24, 2)) insTotalCompany,
            CONVERT(a.accumulation_base, decimal(24, 2)) accumulationBase,
            CONVERT(a.accumulation_person_scale, decimal(24, 2)) accumulationPersonScale,
            CONVERT(a.accumulation_company_scale, decimal(24, 2)) accumulationCompanyScale,
            CONVERT(a.accumulation_person_amount, decimal(24, 2)) accumulationPersonAmount,
            CONVERT(a.accumulation_company_amount, decimal(24, 2)) accumulationCompanyAmount
        FROM
            wages_social_security_fund a,
            wages_social_security_fund_applicable_objects b
        WHERE a.id = b.security_fund_id
        AND a.state = 1
        AND date_format(CONCAT(a.start_month, '-01'), '%Y-%m') <![CDATA[ <= ]]> #{lastMonthDate}
        AND date_format(CONCAT(a.end_month, '-01'), '%Y-%m') >= #{lastMonthDate}
    </select>

</mapper>